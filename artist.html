<html>
<head>
    <title>Simple turtle drawing</title>
    <style>
        #drawing {
          border: 1px solid #999;
        }
        #command {
          width: 400px;
          height: 150px;
        }
    </style>
</head>
<body>

<center>
    <textarea id="command"></textarea><br/>
    <button id="run">Draw</button> <button id="run2">Draw Slowly</button>
    <br/><br/>
    <canvas id="drawing" width="400" height="300"></canvas>
</center>

<script>
var canvas = document.getElementById('drawing');
var ctx = canvas.getContext('2d');

var cx, cy, ca, pen;
var cmds;
var delay;

function reinit() {
    cx = Math.floor(canvas.width / 2) + 0.5;
    cy = Math.floor(canvas.height / 2) + 0.5;
    ca = 0;
    pen = true;
    ctx.lineWidth = 2;
    ctx.fillStyle = 'rgb(255, 255, 255)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
}

function rot(da) {
    ca += da;
    while (ca >= 180) {
        ca -= 360;
    }
    while (ca < -180) {
        ca += 360;
    }
}

function fwd(len) {
    var dx = len * Math.cos(ca * Math.PI / 180);
    var dy = len * Math.sin(ca * Math.PI / 180);
    var tx = Math.round(cx + dx);
    var ty = Math.round(cy + dy);
    if (pen) {
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.lineTo(tx, ty);
        ctx.stroke();
    }
    cx = tx;
    cy = ty;
}

function execCmd() {
    if (cmds.length == 0) {
        return;
    }
    var cmd = cmds.shift();
    if (cmd.length == 0) {
        return;
    }
    var d = 1;
    var code = cmd.charAt(0);
    var value = cmd.length > 1 ? parseInt(cmd.substring(1)) : NaN;
    switch (code) {
        case "F": fwd(value); d = delay; break;
        case "B": fwd(-value); d = delay; break;
        case "L": rot(-value); break;
        case "R": rot(value); break;
        case "U": pen = false; break;
        case "D": pen = true; break;
        default: alert("Unknown command: " + cmd);
    }
    setTimeout(execCmd, d);
}

function execute(slowness) {
		delay = slowness > 1 ? slowness : 1;
    reinit();
    var cmdLine = document.getElementById("command").value;
    cmds = cmdLine.toUpperCase().split(/\s+/);
    execCmd();
}

document.getElementById("run").onclick = function() { execute(0) };
document.getElementById("run2").onclick = function() { execute(130) };
</script>

</body>
</html>
